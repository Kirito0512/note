# UDP

## UDP 与 TCP 区别
- TCP : Transmission Control Protocol 传输层控制协议
- UDP : User Datagram Protocol 用户数据报协议
- TCP 面向连接（通信前需要建立连接），UDP 不面向连接（发送数据之前不需要建立连接）
- TCP 占用系统资源较多（需要建立连接，数据头 20 字节），UDP 占用系统资源较少
- TCP 提供可靠的数据服务（无差错，不丢失，不重复，且按序到达），UDP 会尽最大努力交付，但是不保证可靠交付
- TCP 是点对点的；UDP 支持一对一，一对多，多对一以及多对多。

## IP 地址类型
1. A 类 IP 地址

  由 1 字节的网络地址和 3 字节主机地址组成，第一个字节以 `0` 开始， 地址范围从 1.0.0.0 到 127.0.0.0。

  **127 为保留地址，用于测试回环**

2. B 类 IP 地址

  由 2 个字节的网络地址和 2 个字节的主机地址组成，第一个字节以 `10` 开始，地址范围从 128.0.0.0 到 191.255.255.255 。

3. C 类 IP 地址

  由 3 字节的网络地址和 1 字节的主机地址，第一个字节以 `110` 开始，地址范围从 192.0.0.0 到 223.255.255.255。

4. D 类 IP 地址

  用于多播（组播），第一个字节以 `1110` 开始，地址范围从 224.0.0.0 到 239.255.255.255。

  - 224.0.0.0～224.0.0.255为预留的组播地址（永久组地址），地址224.0.0.0保留不做分配，其它地址供路由协议使用；
  - 224.0.1.0～224.0.1.255是公用组播地址，可以用于Internet；
  - 224.0.2.0～238.255.255.255为用户可用的组播地址（临时组地址），全网范围内有效；
  - 239.0.0.0～239.255.255.255为本地管理组播地址，仅在特定的本地范围内有效。

4. E 类 IP 地址

  第一个字节以 `1111` 开始，地址范围从 240.0.0.0 到 255.255.255.255。

## 二层 三层

根据 OSI 的网络协议七层模型（物理层、数据链路层、网络层、传输层、会话层、表示层和应用层），MAC 地址属于物理链路层（二层），IP 地址属于网络层（三层）。


## 广播

广播不会被路由器转发，TCP/IP 协议中只有 UDP 支持广播。

> 网卡从网络上接收到目标物理地址对应的所有 bit 位都为 1 的数据报时，会收到这条消息并将其上传给驱动程序，网卡的这种工作模式称为广播模式，网卡的缺省工作模式包含直接模式和广播模式。

### 受限广播地址

255.255.255.255。仅出现在本地网络中，任何情况下路由器都不转发。

### 直接广播地址

直接广播地址包含一个有效的网络号和一个全 `1` 的主机号，直接广播可以被路由器转发，但默认情况下路由器不转发广播包，需要路由器支持。


## 单播

> 单播的数据只是收发数据的特定主机进行处理。

## 多播

> 有一些特殊的物理地址，他们不能作为任何网卡的实际物理地址使用，但网卡能够设定为不过滤从网络上接收到的一个以这些物理地址中的一个和若干个作为目的物理地址的帧。这些物理地址称为多播传送地址，网卡的这种工作模式称为多播传送模式。

> IANA 将 MAC 地址范围 01:00:5E:00:00:00 ~ 01:00:5E:7F:FF:FF 分配给组播使用，这就要求将28位的 IP 组播地址空间映射到 23 位的 MAC 地址空间中，具体的映射方法是将组播地址中的低 23 位放入 MAC 地址的低 23 位，如下图所示。

> 对于 IP 多播，IP 多播地址会转换成以太网多播地址，一个以太网多播地址可以对应多个 IP 多播地址。

>  IGMP 是 IP 组播的基础。假如不同子网内的 A 和 B 要 进行组播通信，那么位于 AB 之间的所有路由器必须都要支持 IGMP 协议，否则 AB 之间不能进行通信。

多播步骤：

1. 建立一个socket。
- 然后设置多播的参数，例如超时时间TTL、本地回环许可LOOP等。
- 加入多播组。
- 发送和接收数据。
- 从多播组离开。

## 参考链接
- [UDP 单播、广播和多播](http://www.cnblogs.com/lidabo/p/5865045.html)
- [TCP和UDP的最完整的区别](http://blog.csdn.net/li_ning_/article/details/52117463)
- [ 多播(组播)原理分析](http://blog.csdn.net/maopig/article/details/6868626)
- [IP多播技术介绍(一)](http://xuanbo.blog.51cto.com/499334/222246)
